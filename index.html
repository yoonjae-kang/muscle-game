<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Í∑ºÏú° ÌÇ§Ïö∞Í∏∞ Í≤åÏûÑ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000;
        }

        #game-container {
            width: 100%;
            height: 100vh;
            position: relative;
            background: #f5f5f5;
        }

        #character-display {
            width: 100%;
            height: 100%;
            position: relative;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #start-screen h1 {
            color: white;
            font-size: 28px;
            margin-bottom: 20px;
            text-align: center;
            padding: 0 20px;
        }

        #start-screen p {
            color: #ddd;
            font-size: 16px;
            margin-bottom: 30px;
            text-align: center;
            padding: 0 20px;
        }

        .start-btn {
            padding: 15px 40px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
        }

        #level-display {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
            display: none;
        }

        #scenario-box {
            position: absolute;
            bottom: 90px;
            left: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.2);
            display: none;
        }

        #scenario-text {
            font-size: 15px;
            line-height: 1.4;
            margin-bottom: 8px;
            color: #000;
            font-weight: 600;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.9);
        }

        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .choice-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            background: rgba(139, 115, 85, 0.7);
            color: white;
            font-weight: 500;
            text-align: left;
        }

        #stats-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.85);
            padding: 6px;
            display: none;
            grid-template-columns: repeat(4, 1fr);
            gap: 4px;
            z-index: 10;
            height: 70px;
        }

        .stat-item {
            text-align: center;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .stat-label {
            font-size: 10px;
            opacity: 0.8;
            margin-bottom: 2px;
        }

        .stat-value {
            font-size: 13px;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 3px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            margin-top: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #4CAF50;
            transition: width 0.5s;
        }

        .progress-fill.danger {
            background: #f44336;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .overlay.show {
            display: flex;
        }

        .overlay.ending-overlay {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .result-box {
            background: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            max-width: 90%;
            width: 350px;
            position: relative;
            overflow: hidden;
        }

        .ending-box {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .result-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 12px;
            color: #333;
        }

        .result-text {
            font-size: 15px;
            line-height: 1.5;
            margin-bottom: 18px;
            color: #666;
        }

        .btn {
            padding: 12px 30px;
            background: #8B7355;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }

        .btn-green {
            background: #4CAF50;
        }

        .warning {
            background: rgba(255, 107, 107, 0.8);
            color: white;
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 12px;
        }

        .level-up-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: bold;
            color: #FFD700;
            z-index: 2000;
            animation: levelUp 1s ease-out forwards;
            pointer-events: none;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }

        @keyframes levelUp {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="character-display">
            <div id="start-screen">
                <h1>üí™ Í∑ºÏú° ÌÇ§Ïö∞Í∏∞ Í≤åÏûÑ</h1>
                <p>Ïú§Ïû¨Í∞Ä Í±¥Í∞ïÌïú Î≥¥ÎîîÎπåÎçîÍ∞Ä ÎêòÎèÑÎ°ù ÎèÑÏôÄÏ£ºÏÑ∏Ïöî!</p>
                <button class="start-btn" onclick="startGame()">Í≤åÏûÑ ÏãúÏûëÌïòÍ∏∞</button>
            </div>
            
            <div id="level-display">LV.1 Ïú§Ïû¨</div>
            <div id="scenario-box">
                <div id="scenario-text">Í≤åÏûÑÏùÑ ÏãúÏûëÌï©ÎãàÎã§...</div>
                <div class="choice-buttons" id="choices"></div>
            </div>
            <div id="stats-bar">
                <div class="stat-item">
                    <div class="stat-label">Í∑ºÏú°Îüâ</div>
                    <div class="stat-value"><span id="muscle">20</span>kg</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="muscle-bar"></div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Ï≤¥ÏßÄÎ∞©Î•†</div>
                    <div class="stat-value"><span id="fat">33</span>%</div>
                    <div class="progress-bar">
                        <div class="progress-fill danger" id="fat-bar"></div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">ÏùòÏöï</div>
                    <div class="stat-value"><span id="motivation">50</span></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="motivation-bar"></div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Î¨¥Í∏∞Î†•</div>
                    <div class="stat-value"><span id="lethargy">0</span></div>
                    <div class="progress-bar">
                        <div class="progress-fill danger" id="lethargy-bar"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="overlay" id="result-overlay">
        <div class="result-box">
            <h2 class="result-title" id="result-title">Í≤∞Í≥º</h2>
            <p class="result-text" id="result-text">ÌÖçÏä§Ìä∏</p>
            <button class="btn" onclick="hideResult()">Í≥ÑÏÜçÌïòÍ∏∞</button>
        </div>
    </div>

    <div class="overlay ending-overlay" id="ending-overlay">
        <div class="result-box ending-box">
            <h2 class="result-title" id="ending-title">ÏóîÎî©</h2>
            <p class="result-text" id="ending-text">ÌÖçÏä§Ìä∏</p>
            <button class="btn btn-green" onclick="location.reload()">Îã§Ïãú ÏãúÏûë</button>
        </div>
    </div>

    <script>
const gameState = {
    level: 1,
    muscle: 20,
    fat: 33,
    motivation: 50,
    lethargy: 0,
    currentScenario: 0,
    specialPath: null,
    specialStep: 0,
    goodChoices: 0,
    lastSpecialChoice: null,
    surgeryEventShown: false,
    drugEventShown: false
};

const characterImages = {
    1: 'https://i.imgur.com/rHDox3L.png',
    7: 'https://i.imgur.com/wPCS6fA.png',
    13: 'https://i.imgur.com/yea3RHW.png',
    18: 'https://i.imgur.com/bA6xX7Q.jpeg'
};

const scenarios = [
    {
        text: "Î∞§ 10Ïãú, Ïò§Îäò Ïö¥ÎèôÏùÑ ÎπºÎ®πÏóàÎã§Îäî Í±∏ Íπ®Îã¨ÏïòÏñ¥Ïöî. ÌîºÍ≥§ÌïòÏßÄÎßå Ìó¨Ïä§Ïû•ÏùÄ ÏïÑÏßÅ Ïó¥Î†§ÏûàÏñ¥Ïöî.",
        choices: [
            { text: "ÌîºÍ≥§Ìï¥ÎèÑ Ïö¥ÎèôÌïòÎü¨ Í∞ÄÍ∏∞", muscle: 0.8, fat: -0.8, motivation: 15, lethargy: -1, good: true },
            { text: "Ïò§ÎäòÏùÄ Ïâ¨Í≥† ÎÇ¥Ïùº Îçî Ïó¥Ïã¨Ìûà", muscle: -0.3, fat: 0.4, motivation: -5, lethargy: 2, bad: true },
            { text: "ÏßëÏóêÏÑú ÌôàÌä∏Î†àÏù¥ÎãùÌïòÍ∏∞", muscle: 0.5, fat: -0.4, motivation: 8, lethargy: 0 }
        ]
    },
    {
        text: "ÏπúÍµ¨Îì§Ïù¥ ÏπòÌÇ®Í≥º Îß•Ï£º ÌååÌã∞Î•º ÌïòÏûêÍ≥† Ìï¥Ïöî. ÌïòÏßÄÎßå Îã§Ïù¥Ïñ¥Ìä∏ Ï§ëÏù¥ÏóêÏöî.",
        choices: [
            { text: "Îã≠Í∞ÄÏä¥ÏÇ¥ ÎèÑÏãúÎùΩ Ïã∏Í∞ÄÍ∏∞", muscle: 0.7, fat: -0.9, motivation: 10, lethargy: -1, good: true },
            { text: "Ìïú Î≤àÏØ§ÏùÄ Í¥úÏ∞ÆÏïÑ! Ï¶êÍ∏∞Í∏∞", muscle: -0.5, fat: 1.2, motivation: -15, lethargy: 3, bad: true },
            { text: "ÏÜåÎüâÎßå Î®πÍ≥† Ïö¥ÎèôÏúºÎ°ú Î≥¥Ï∂©", muscle: 0.2, fat: 0.3, motivation: 0, lethargy: 1 }
        ]
    },
    {
        text: "ÏÉàÎ≤Ω 5Ïãú ÏïåÎûåÏù¥ Ïö∏Î†§Ïöî. Ïò§ÎäòÏùÄ ÌïòÏ≤¥ Ïö¥ÎèôÌïòÎäî ÎÇ†Ïù¥ÏóêÏöî.",
        choices: [
            { text: "Î∞îÎ°ú ÏùºÏñ¥ÎÇòÏÑú Ïö¥Îèô Ï§ÄÎπÑ", muscle: 1.0, fat: -1.0, motivation: 20, lethargy: -2, good: true },
            { text: "30Î∂ÑÎßå Îçî ÏûêÍ≥† ÏùºÏñ¥ÎÇòÍ∏∞", muscle: 0.4, fat: -0.4, motivation: 5, lethargy: 1 },
            { text: "Ïò§ÎäòÏùÄ Í±¥ÎÑàÎõ∞Í≥† Îçî ÏûêÍ∏∞", muscle: -0.6, fat: 0.6, motivation: -20, lethargy: 4, bad: true }
        ]
    },
    {
        text: "PT Ìä∏Î†àÏù¥ÎÑàÍ∞Ä ÏãùÎã®ÏùÑ Îçî ÏóÑÍ≤©ÌïòÍ≤å ÏßÄÌÇ§ÎùºÍ≥† Ìï¥Ïöî. ÌïòÏßÄÎßå ÎÑàÎ¨¥ ÌûòÎì§Ïñ¥Ïöî.",
        choices: [
            { text: "ÏôÑÎ≤ΩÌïòÍ≤å ÏßÄÌÇ§Í∏∞Î°ú Í≤∞Ïã¨", muscle: 1.2, fat: -1.2, motivation: 15, lethargy: -1, good: true },
            { text: "80% Ï†ïÎèÑÎßå ÏßÄÌÇ§Í∏∞", muscle: 0.6, fat: -0.6, motivation: 8, lethargy: 0 },
            { text: "ÎÑàÎ¨¥ Ïä§Ìä∏Î†àÏä§ Î∞õÏïÑÏÑú Ìè¨Í∏∞", muscle: -0.8, fat: 1.0, motivation: -25, lethargy: 5, bad: true }
        ]
    },
    {
        text: "Í∞ÄÏä¥ Ïö¥ÎèôÌïòÎäî ÎÇ†, Î≤§ÏπòÌîÑÎ†àÏä§Î•º ÌïòÎã§Í∞Ä Î∞îÎ≤®Ïóê ÍπîÎ†∏Ïñ¥Ïöî! Îã§Îì§ Ï≥êÎã§Î≥¥Í≥† ÏûàÏñ¥Ïöî.",
        choices: [
            { text: "ÌÑ∏Í≥† ÏùºÏñ¥ÎÇòÏÑú Ïö¥Îèô Í≥ÑÏÜçÌïòÍ∏∞", muscle: 1.0, fat: -0.7, motivation: 20, lethargy: -2, good: true },
            { text: "Î∂ÄÎÅÑÎü¨ÏõåÏÑú ÏßëÏúºÎ°ú ÎèÑÎßùÏπòÍ∏∞", muscle: -0.5, fat: 0.2, motivation: -30, lethargy: 4, bad: true },
            { text: "Ïïà ÍπîÎ¶∞ Ï≤ô Î∞îÎã•Ïóê ÎàÑÏõå ÏûêÎäî Ï≤ôÌïòÍ∏∞", muscle: 0, fat: 0.5, motivation: -15, lethargy: 3 }
        ]
    },
    {
        text: "Ïò§Îäò ÏïÑÏπ® Í±∞Ïö∏ÏùÑ Î¥§ÎäîÎç∞ ÎààÎ∞îÎîîÍ∞Ä ÎßàÏùåÏóê Ïïà Îì§Ïñ¥Ïöî. ÏÇ¥Ïù¥ Ï∞ê Í≤É Í∞ôÏïÑÏöî.",
        choices: [
            { text: "ÌïòÎ£®Ï¢ÖÏùº Ïó¥Ïã¨Ìûà ÏãùÎã®ÌïòÍ≥† ÏõÄÏßÅÏù¥Í∏∞", muscle: 0.9, fat: -1.0, motivation: 15, lethargy: -1, good: true },
            { text: "ÏóêÎùº Î™®Î•¥Í≤†Îã§! Ïò§ÎäòÏùÄ ÏπòÌåÖ Îç∞Ïù¥", muscle: -0.4, fat: 1.5, motivation: -20, lethargy: 4, bad: true },
            { text: "ÏùºÎã® Í∞ÅÎèÑ ÎßûÏ∂∞ÏÑú Ïù∏Ïä§ÌÉÄÏö© ÏÇ¨ÏßÑ Ï∞çÍ∏∞", muscle: 0.1, fat: 0.2, motivation: 5, lethargy: 1 }
        ]
    },
    {
        text: "ÏÉàÎ≤Ω 2Ïãú, ÎÑ∑ÌîåÎ¶≠Ïä§ ÏãúÎ¶¨Ï¶àÍ∞Ä ÎÑàÎ¨¥ Ïû¨Î∞åÏñ¥Ïöî! ÎÇ¥Ïùº ÏïÑÏπ® Ïö¥ÎèôÏù¥ ÏûàÎäîÎç∞...",
        choices: [
            { text: "Î∞îÎ°ú ÎÅÑÍ≥† ÏûêÏÑú Ï∂©Î∂ÑÌïú ÏàòÎ©¥ Ï∑®ÌïòÍ∏∞", muscle: 0.7, fat: -0.6, motivation: 15, lethargy: -2, good: true },
            { text: "ÏãúÎ¶¨Ï¶à Ï†ïÏ£ºÌñâÌïòÎ©∞ Î∞§ÏÉàÍ∏∞", muscle: -0.6, fat: 0.8, motivation: -25, lethargy: 5, bad: true },
            { text: "Ìïú Ìé∏Îßå Îçî Î≥¥Í≥† ÏûêÍ∏∞", muscle: 0.2, fat: 0.1, motivation: -5, lethargy: 2 }
        ]
    },
    {
        text: "Î≥¥Ï∂©Ï†úÎ•º ÏÇ¨Ïïº Ìï† ÏãúÍ∏∞Í∞Ä ÏôîÏñ¥Ïöî. Í∑ºÏú° ÏÑ±Ïû•Ïóê ÎèÑÏõÄÏù¥ Îê†ÍπåÏöî?",
        choices: [
            { text: "ÌíàÏßà Ï¢ãÏùÄ ÌîÑÎ°úÌã¥ ÌååÏö∞Îçî Íµ¨Îß§ÌïòÍ∏∞", muscle: 1.1, fat: -0.5, motivation: 15, lethargy: -1, good: true },
            { text: "Îã®Î∞±Ïßà Ï±ôÍ≤®Î®πÍ∏∞ ÎÑàÎ¨¥ Í∑ÄÏ∞ÆÏïÑ", muscle: -0.7, fat: 0.6, motivation: -20, lethargy: 3, bad: true },
            { text: "ÏùºÎã® ÏûêÏó∞ÏãùÏúºÎ°ú Îã®Î∞±Ïßà ÏÑ≠Ï∑®ÌïòÍ∏∞", muscle: 0.5, fat: -0.2, motivation: 8, lethargy: 0 }
        ]
    },
    {
        text: "ÏΩúÎ°ùÏΩúÎ°ù... Ïò§ÎäòÏùÄ Ïª®ÎîîÏÖòÏù¥ Î≥ÑÎ°úÏòàÏöî. Î™©ÎèÑ ÏïÑÌîÑÍ≥† Î™∏ÎèÑ Î¨¥Í±∞ÏõåÏöî.",
        choices: [
            { text: "ÌèâÏÜåÏ≤òÎüº Í≥†Í∞ïÎèÑÎ°ú Î∞ÄÏñ¥Î∂ôÏù¥Í∏∞", muscle: -0.3, fat: 0.2, motivation: -10, lethargy: 4, bad: true },
            { text: "Ïª®ÎîîÏÖòÏóê ÎßûÏ∂∞ Í∞ÄÎ≤ºÏö¥ Ïö¥ÎèôÌïòÍ∏∞", muscle: 0.4, fat: -0.3, motivation: 10, lethargy: -1, good: true },
            { text: "Ïö¥Îèô ÎåÄÏã† Í±∞Ïö∏ ÏïûÏóêÏÑú Ìè¨Ï¶àÎßå Ï∑®ÌïòÍ∏∞", muscle: 0, fat: 0.4, motivation: -5, lethargy: 2 }
        ]
    }
];

const specialScenarios = {
    surgery: {
        step1: {
            text: "Ïù∏Ïä§ÌÉÄÍ∑∏Îû®ÏóêÏÑú ÏÑ±ÌòïÏúºÎ°ú ÏôÑÎ≤ΩÌïú Î™∏Îß§Î•º ÎßåÎì† Ïù∏ÌîåÎ£®Ïñ∏ÏÑúÎ•º Î¥§Ïñ¥Ïöî.",
            warning: true,
            choices: [
                { text: "ÏÑ±ÌòïÏàòÏà†Î°ú Îπ†Î•∏ Í≤∞Í≥º ÏñªÍ∏∞ üíÄ", special: 'surgery', muscle: 3, fat: -6, motivation: 40, lethargy: -5 },
                { text: "ÏûêÏó∞Ïä§ÎüΩÍ≤å Ïö¥ÎèôÏúºÎ°ú ÎßåÎì§Í∏∞", muscle: 0.8, fat: -0.8, motivation: 15, lethargy: -1, good: true },
                { text: "Îçî ÏûêÏÑ∏Ìûà ÏïåÏïÑÎ≥¥Í∏∞", muscle: 0, fat: 0, motivation: 5, lethargy: 0 }
            ]
        },
        step2: {
            text: "ÏàòÏà†ÏùÄ ÏÑ±Í≥µÏ†ÅÏù¥ÏóàÏñ¥Ïöî! Ïù∏Ïä§ÌÉÄÍ∑∏Îû® ÌåîÎ°úÏõåÍ∞Ä 10ÎßåÎ™ÖÏù¥ ÎÑòÏóàÏñ¥Ïöî. ÌïòÏßÄÎßå Í∞ÄÏä¥Ïù¥ Ïù¥ÏÉÅÌïòÍ≤å ÏïÑÌååÏöî...",
            choices: [
                { text: "Î≥ëÏõêÏóê Í∞ÄÏÑú Í≤ÄÏÇ¨Î∞õÍ∏∞", result: 'late' },
                { text: "ÏßÑÌÜµÏ†ú Î®πÍ≥† Ï∞∏Í∏∞", result: 'worse' }
            ]
        },
        step3_late: {
            text: "ÏùòÏÇ¨Í∞Ä Ïã¨Í∞ÅÌïú ÌëúÏ†ïÏúºÎ°ú ÎßêÌï¥Ïöî. 'Î≥¥ÌòïÎ¨ºÏóê Î¨∏Ï†úÍ∞Ä ÏÉùÍ≤ºÏñ¥Ïöî. Ï¶âÏãú Ï†úÍ±∞ ÏàòÏà†Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.'",
            choices: [
                { text: "ÎπöÏùÑ ÎÇ¥ÏÑúÎùºÎèÑ ÏàòÏà†Î∞õÍ∏∞", result: 'poor_end' }
            ]
        },
        step3_worse: {
            text: "Í≥†ÌÜµÏù¥ Ï†êÏ†ê Ïã¨Ìï¥Ï†∏Ïöî. Î≥¥ÌòïÎ¨ºÏù¥ ÌÑ∞ÏßÑ Í≤É Í∞ôÏïÑÏöî. ÏùëÍ∏âÏã§Î°ú Ïã§Î†§Í∞îÏßÄÎßå...",
            choices: []
        }
    },
    drug: {
        step1: {
            text: "Ìó¨Ïä§Ïû•ÏóêÏÑú ÎßåÎÇú ÏÑ†Î∞∞Í∞Ä ÏïΩÎ¨ºÏùÑ Í∂åÌï¥Ïöî. 'Ïù¥Í±∞ Î®πÏúºÎ©¥ 3Í∞úÏõî ÏïàÏóê ÎåÄÌöå ÎÇòÍ∞à Ïàò ÏûàÏñ¥.'",
            warning: true,
            choices: [
                { text: "ÏïΩÎ¨ºÎ°ú Îπ†Î•∏ Í∑ºÏú° Ï¶ùÍ∞Ä üíÄ", special: 'drug', muscle: 6, fat: -10, motivation: 60, lethargy: -8 },
                { text: "ÏûêÏó∞Ï†ÅÏù∏ Î∞©Î≤ï Í≥†ÏàòÌïòÍ∏∞", muscle: 1.0, fat: -0.8, motivation: 15, lethargy: -1, good: true },
                { text: "Î∂ÄÏûëÏö©Ïóê ÎåÄÌï¥ Î¨ºÏñ¥Î≥¥Í∏∞", muscle: 0, fat: 0, motivation: 5, lethargy: 0 }
            ]
        },
        step2: {
            text: "Î≥¥ÎîîÎπåÎî© ÎåÄÌöåÏóêÏÑú Ïö∞ÏäπÌñàÏñ¥Ïöî! ÌïòÏßÄÎßå ÏµúÍ∑º Ïã¨Ïû•Ïù¥ Ïù¥ÏÉÅÌïòÍ≤å Îõ∞Í≥†, Î®∏Î¶¨Ïπ¥ÎùΩÏù¥ Îπ†ÏßÄÍ∏∞ ÏãúÏûëÌñàÏñ¥Ïöî...",
            choices: [
                { text: "ÏïΩÎ¨º Ï§ëÎã®ÌïòÍ≥† Î≥ëÏõê Í∞ÄÍ∏∞", result: 'late' },
                { text: "Ï°∞Í∏àÎßå Îçî ÏÇ¨Ïö©ÌïòÍ∏∞", result: 'worse' }
            ]
        },
        step3_late: {
            text: "ÏùòÏÇ¨Ïùò ÏßÑÎã®Ïù¥ Ï∂©Í≤©Ï†ÅÏù¥ÏóêÏöî. 'Í∞ÑÍ≥º Ïã†Ïû•Ïù¥ Ïã¨Í∞ÅÌïòÍ≤å ÏÜêÏÉÅÎêêÏäµÎãàÎã§.'",
            choices: [
                { text: "ÏπòÎ£åÏóê Ï†ÑÎÖêÌïòÍ∏∞", result: 'sick_end' }
            ]
        },
        step3_worse: {
            text: "Î™∏Ïù¥ Í∏âÍ≤©Ìûà Î¨¥ÎÑàÏßÄÍ∏∞ ÏãúÏûëÌñàÏñ¥Ïöî. Í∑ºÏú°ÏùÄ ÎÖπÏïÑÎÇ¥Î¶¨Í≥†, Ïû•Í∏∞Îì§Ïù¥ ÌïòÎÇòÎëò Í∏∞Îä•ÏùÑ Î©àÏ∂∞Í∞ÄÏöî...",
            choices: []
        }
    }
};

function shuffleChoices(choices) {
    const shuffled = [...choices];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}

function startGame() {
    document.getElementById('start-screen').style.display = 'none';
    document.getElementById('level-display').style.display = 'block';
    document.getElementById('scenario-box').style.display = 'block';
    document.getElementById('stats-bar').style.display = 'grid';
    updateStats();
    showScenario();
}

function updateCharacterImage() {
    const display = document.getElementById('character-display');
    let imageUrl;
    
    if (gameState.level >= 18) imageUrl = characterImages[18];
    else if (gameState.level >= 13) imageUrl = characterImages[13];
    else if (gameState.level >= 7) imageUrl = characterImages[7];
    else imageUrl = characterImages[1];
    
    display.style.backgroundImage = `url('${imageUrl}')`;
}

function showLevelUpEffect() {
    const effect = document.createElement('div');
    effect.className = 'level-up-effect';
    effect.textContent = 'LEVEL UP!';
    document.body.appendChild(effect);
    
    setTimeout(() => {
        effect.remove();
    }, 1000);
}

function updateStats() {
    document.getElementById('muscle').textContent = gameState.muscle.toFixed(1);
    document.getElementById('fat').textContent = gameState.fat.toFixed(1);
    document.getElementById('motivation').textContent = Math.round(gameState.motivation);
    document.getElementById('lethargy').textContent = Math.round(gameState.lethargy);

    document.getElementById('muscle-bar').style.width = (gameState.muscle / 38 * 100) + '%';
    document.getElementById('fat-bar').style.width = (gameState.fat / 33 * 100) + '%';
    document.getElementById('motivation-bar').style.width = gameState.motivation + '%';
    document.getElementById('lethargy-bar').style.width = (gameState.lethargy * 10) + '%';
    
    const oldLevel = gameState.level;
    
    if (gameState.goodChoices > 0) {
        gameState.level = Math.min(22, gameState.level + 1);
        gameState.goodChoices = 0;
        
        if (gameState.level > oldLevel) {
            showLevelUpEffect();
        }
    }
    
    document.getElementById('level-display').textContent = 'LV.' + gameState.level + ' Ïú§Ïû¨';
    updateCharacterImage();
}

function showScenario() {
    if (gameState.lethargy >= 10) {
        showEnding('Î¨¥Í∏∞Î†• ÏóîÎî© üòî', 'Î¨¥Í∏∞Î†•Ïóê Îπ†Ï†∏ Î≥¥ÎîîÎπåÎî©ÏùÑ Ìè¨Í∏∞ÌñàÏñ¥Ïöî.');
        return;
    }
    if (gameState.motivation <= 0) {
        showEnding('Ìè¨Í∏∞ ÏóîÎî© üò¢', 'ÏùòÏöïÏùÑ ÏôÑÏ†ÑÌûà ÏûÉÏñ¥Î≤ÑÎ†∏Ïñ¥Ïöî.');
        return;
    }
    if (gameState.level >= 18) {
        showEnding('Î≥¥ÎîîÎπåÎçî ÏÑ±Í≥µ! üèÜ', 'Ïú§Ïû¨Îäî Í±¥Í∞ïÌïú Î∞©Î≤ïÏúºÎ°ú ÏôÑÎ≤ΩÌïú Î™∏ÏùÑ ÎßåÎì§ÏóàÏñ¥Ïöî!');
        return;
    }

    let scenario;
    
    if (gameState.specialPath) {
        if (gameState.specialPath === 'surgery') {
            if (gameState.specialStep === 1) {
                scenario = specialScenarios.surgery.step2;
            } else if (gameState.specialStep === 2) {
                scenario = gameState.lastSpecialChoice === 'late' 
                    ? specialScenarios.surgery.step3_late 
                    : specialScenarios.surgery.step3_worse;
            }
        } else if (gameState.specialPath === 'drug') {
            if (gameState.specialStep === 1) {
                scenario = specialScenarios.drug.step2;
            } else if (gameState.specialStep === 2) {
                scenario = gameState.lastSpecialChoice === 'late' 
                    ? specialScenarios.drug.step3_late 
                    : specialScenarios.drug.step3_worse;
            }
        }
        gameState.specialStep++;
    } else {
        if (gameState.level === 7 && Math.random() > 0.5) {
            scenario = specialScenarios.surgery.step1;
        } else if (gameState.level === 18 && Math.random() > 0.5) {
            scenario = specialScenarios.drug.step1;
        } else {
            scenario = scenarios[gameState.currentScenario];
            gameState.currentScenario = (gameState.currentScenario + 1) % scenarios.length;
        }
    }

    const textDiv = document.getElementById('scenario-text');
    if (scenario.warning) {
        textDiv.innerHTML = '<div class="warning">‚ö†Ô∏è ÏúÑÌóòÌïú ÏÑ†ÌÉùÏûÖÎãàÎã§!</div>' + scenario.text;
    } else {
        textDiv.textContent = scenario.text;
    }

    const choicesDiv = document.getElementById('choices');
    choicesDiv.innerHTML = '';
    
    if (scenario.choices.length === 0) {
        setTimeout(() => {
            if (gameState.specialPath === 'surgery') {
                showEnding('ÏàòÏà† Ìï©Î≥ëÏ¶ù ÏÇ¨Îßù üíÄ', 'Î≥¥ÌòïÎ¨º Í¥ÄÎ¶¨Î•º Ï†úÎåÄÎ°ú ÌïòÏßÄ Î™ªÌï¥ Ìå®ÌòàÏ¶ùÏúºÎ°ú ÏÇ¨ÎßùÌñàÏäµÎãàÎã§.');
            } else if (gameState.specialPath === 'drug') {
                showEnding('ÏïΩÎ¨º Î∂ÄÏûëÏö© ÏÇ¨Îßù üíÄ', 'ÏïΩÎ¨º Î∂ÄÏûëÏö©ÏúºÎ°ú Ïû•Í∏∞Í∞Ä ÎßùÍ∞ÄÏ†∏ ÏÇ¨ÎßùÌñàÏäµÎãàÎã§.');
            }
        }, 2000);
        return;
    }
    
    const shuffledChoices = shuffleChoices(scenario.choices);
    
    shuffledChoices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice.text;
        btn.onclick = () => handleChoice(choice);
        choicesDiv.appendChild(btn);
    });
}

function handleChoice(choice) {
    if (choice.special) {
        gameState.specialPath = choice.special;
        gameState.specialStep = 1;
    }

    if (choice.result) {
        gameState.lastSpecialChoice = choice.result;
        
        if (choice.result === 'poor_end') {
            showResult('ÎπöÎçîÎØ∏', 'ÏàòÏà†ÏùÄ ÏÑ±Í≥µÌñàÏßÄÎßå Í±∞Ïï°Ïùò ÎπöÏùÑ ÏßÄÍ≤å ÎêòÏóàÏñ¥Ïöî...', () => {
                showEnding('ÌååÏÇ∞ ÏóîÎî©', 'ÏÑ±ÌòïÏàòÏà†Ïùò ÎåÄÍ∞ÄÎ°ú Î™®Îì† Í≤ÉÏùÑ ÏûÉÏóàÏäµÎãàÎã§.');
            });
            return;
        } else if (choice.result === 'sick_end') {
            showResult('Ìà¨Î≥ë ÏÉùÌôú', 'ÏïΩÎ¨º Î∂ÄÏûëÏö©ÏúºÎ°ú ÌèâÏÉù Ìà¨Î≥ëÌïòÎ©∞ ÏÇ¥ÏïÑÍ∞ÄÍ≤å ÎêòÏóàÏñ¥Ïöî...', () => {
                showEnding('Í±¥Í∞ï ÏÉÅÏã§ ÏóîÎî©', 'ÏïΩÎ¨ºÏùò ÎåÄÍ∞ÄÎäî ÎÑàÎ¨¥ Ïª∏ÏäµÎãàÎã§.');
            });
            return;
        }
    }

    if (choice.good) {
        gameState.goodChoices++;
    }

    gameState.muscle = Math.max(20, Math.min(38, gameState.muscle + (choice.muscle || 0)));
    gameState.fat = Math.max(7, Math.min(33, gameState.fat + (choice.fat || 0)));
    gameState.motivation = Math.max(0, Math.min(100, gameState.motivation + (choice.motivation || 0)));
    gameState.lethargy = Math.max(0, Math.min(10, gameState.lethargy + (choice.lethargy || 0)));

    updateStats();

    if (gameState.specialPath) {
        if (choice.special) {
            showResult('ÏúÑÌóòÌïú ÏÑ†ÌÉù...', 'ÎèåÏù¥ÌÇ¨ Ïàò ÏóÜÎäî Í∏∏ÏùÑ ÏÑ†ÌÉùÌñàÏäµÎãàÎã§.', () => {
                setTimeout(showScenario, 300);
            });
        } else if (choice.result) {
            setTimeout(showScenario, 500);
        } else {
            showResult('Í≤∞Í≥º', 'ÏÑ†ÌÉùÏùò Í≤∞Í≥ºÍ∞Ä ÎÇòÌÉÄÎÇ¨ÏäµÎãàÎã§.', () => {
                setTimeout(showScenario, 300);
            });
        }
        return;
    }

    let title = 'Í≤∞Í≥º';
    let text = '';
    
    if (choice.good) {
        title = 'ÌõåÎ•≠Ìïú ÏÑ†ÌÉù! üí™‚ú®';
        text = 'Í∑ºÏú°Ïù¥ Îπ†Î•¥Í≤å ÏÑ±Ïû•ÌïòÍ≥† ÏûàÏñ¥Ïöî! Î†àÎ≤®Ïù¥ Ïò¨ÎûêÏäµÎãàÎã§!';
    } else if (choice.bad) {
        title = 'ÏïÑÏâ¨Ïö¥ ÏÑ†ÌÉù üòî';
        text = 'Îçî Ï¢ãÏùÄ ÏÑ†ÌÉùÏùÑ Ìï† Ïàò ÏûàÏóàÏñ¥Ïöî.';
    } else {
        title = 'Í¥úÏ∞ÆÏùÄ ÏÑ†ÌÉù üëç';
        text = 'Ï°∞Í∏àÏî© Î∞úÏ†ÑÌïòÍ≥† ÏûàÏñ¥Ïöî.';
    }

    showResult(title, text);
}

function showResult(title, text, callback) {
    document.getElementById('result-title').textContent = title;
    document.getElementById('result-text').textContent = text;
    document.getElementById('result-overlay').classList.add('show');
    
    window.resultCallback = callback;
}

function hideResult() {
    document.getElementById('result-overlay').classList.remove('show');
    if (window.resultCallback) {
        window.resultCallback();
        window.resultCallback = null;
    } else if (!gameState.specialPath) {
        setTimeout(showScenario, 300);
    }
}

function showEnding(title, text) {
    document.getElementById('ending-title').textContent = title;
    document.getElementById('ending-text').textContent = text;
    
    const endingOverlay = document.getElementById('ending-overlay');
    
    // ÌäπÎ≥Ñ ÏóîÎî© Î∞∞Í≤Ω Ïù¥ÎØ∏ÏßÄ ÏÑ§Ï†ï - Ï†ÑÏ≤¥ ÌôîÎ©¥Ïóê ÌëúÏãú
    if (title.includes('ÏàòÏà†') || title.includes('ÏÑ±Ìòï') || title.includes('ÌååÏÇ∞')) {
        // ÏàòÏà† Í¥ÄÎ†® ÏóîÎî©
        endingOverlay.style.backgroundImage = `url('https://i.imgur.com/sKpOMgJ.png')`;
    } else if (title.includes('ÏïΩÎ¨º') || title.includes('Í±¥Í∞ï ÏÉÅÏã§')) {
        // ÏïΩÎ¨º Í¥ÄÎ†® ÏóîÎî©
        endingOverlay.style.backgroundImage = `url('https://i.imgur.com/9M8uEKl.jpeg')`;
    } else if (title.includes('ÏÑ±Í≥µ')) {
        // ÏÑ±Í≥µ ÏóîÎî©
        endingOverlay.style.backgroundImage = `url('${characterImages[18]}')`;
    } else {
        // ÏùºÎ∞ò ÏóîÎî© - Í≤ÄÏùÄ Î∞∞Í≤Ω
        endingOverlay.style.backgroundImage = 'none';
        endingOverlay.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
    }
    
    endingOverlay.classList.add('show');
}
    </script>
</body>
</html>